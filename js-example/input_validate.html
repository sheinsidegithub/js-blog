<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>及时验证</title>
		<style>
			#error{
				color:red;
				font-weight:bold;
			}
			p{margin:0;padding:0;}
		</style>
		<script type="text/javascript">
	  // Firefox, Google Chrome, Opera, Safari, Internet Explorer from version 9
			function OnInput (event) {
				//alert ("The new content: " + event.target.value);
				var value = event.target.value;
				checkusername(value);
			}
	  // Internet Explorer
			function OnPropChanged (event) {
			console.info(event)
				if (event.propertyName.toLowerCase () == "value") {
					var value = event.srcElement.value;
					checkusername(value);
				}
			} 
		//验证用户名方法(只能是数字字母和中文，不能包括特殊字符)
		function checkusername(value){
			var regex = /^[0-9a-zA-Z\u4e00-\u9fa5]*$/;//数字字母汉字
			var regex1 = /^[0-9a-zA-Z]*$/;//数字字母

			if(regex1.test(value) == true){
				//格式正确
				document.getElementById("error").innerHTML="";
			}else{
				//格式错误
				document.getElementById("error").innerHTML="用户名格式错误，用户名由数字、字母、中文组成，不能包含特殊字符";
			}
		}
		/*$('input[name="username"]').bind('input propertychange', function() {
		    checkusername($(this).val());
		});*/
		function noPermitInput(e){       
       var evt = window.event || e ;     
        if(isIE()){     
            evt.returnValue=false; //ie 禁止键盘输入     
        }else{     
            evt.preventDefault(); //fire fox 禁止键盘输入     
        }        
}     
function isIE() {     
    if (window.navigator.userAgent.toLowerCase().indexOf("msie") >= 1)     
        return true;     
    else     
        return false;     
}    
		</script>
	</head>
	<body>
	<p>在 Web应用开发过程中时常会碰到需要动态监听输入框值变化的情况，比如需要用js动态验证简单的规则，大家首先想到的可能是 onkeydown、onkeypress、onkeyup、onchange 这几个事件来监听输入变化.</p>
	<p>但是这些事件不能监听右键的复制、剪贴和粘贴这些操作，处理组合快捷键也很麻烦。因此今天这篇文章向大家介绍一种完美的解决方案：结合 oninput 和 onpropertychange 事件来监听输入框值变化。</p>
	<h2>首先我们来看几个事件的说明和互相的区别：</2>
	<ul>
		
		<li>1、onchange事件：在内容改变（两次内容有可能相等）且失去焦点时触发；</li>
		<li>2、onpropertychange事件：是实时触发，每增加或删除一个字符就会触发，通过js改变也会触发该事件，但是该事件是IE专有。</li>
		<li>3、oninput事件：是 HTML5 的标准事件，对于检测 textarea, input:text, input:password 和 input:search 这几个元素通过用户界面发生的内容变化非常有用，在内容修改后立即被触发，不像 onchange 事件需要失去焦点才触发。是IE之外的大多数浏览器支持的事件，在value改变时实时触发，但是通过js改变value时不会触发。（IE9以上版本支持oninput）</li>
		<li>4、oninput事件和onpropertychange事件的区别</li>
		<p>onpropertychange事件是任何属性改变都会触发，而oninput却只在value改变时触发，oninput要通过addEventListener()来注册，onpropertychange注册方法与一般事件相同。</p>
		<li>5、 oninput与onpropertychange失效的情况：</li>
		<p>oninput事件：</p>
		<p>（1）当脚本中改变value时，不会触发；</p>
		<p>（2）从浏览器的自动下拉提示中选取时，不会触发；</p>
		<p>onpropertychange事件：</p>
		<p>（1）当input设置为disable=true后，不会触发。</p>
		<p>修改了 input:checkbox 或者 input:radio 元素的选择中状态， checked 属性发生变化。</p>
		<p>修改了 input:text 或者 textarea 元素的值，value 属性发生变化。</p>
		<p>修改了 select 元素的选中项，selectedIndex 属性发生变化。</p>
		<u>在监听到 onpropertychange 事件后，可以使用 event 的 propertyName 属性来获取发生变化的属性名称。</u>
	</ul>
		请输入用户名：
		<input name="username" type="text" oninput="OnInput (event)" onpropertychange="OnPropChanged (event)" placeholder="数字、字母、汉字" /><label id="error"></label>

		  禁止键盘按键输入及中文输入     
  <input type="text" value=""   style="ime-mode:disabled" onkeypress="noPermitInput(event)" >  

  <script type="text/javascript">
function Numbers(e){
	var keynum
	var keychar
	var numcheck
	keynum = e.keyCode || e.which  //ie and not ie Unicode 值
	keychar = String.fromCharCode(keynum)
	numcheck = /\d/;
	return numcheck.test(keychar)
}

</script>

<form>
<input type="text" onkeypress="return Numbers(event)" />
</form> 

	</body>
</html>
</body>
</html>